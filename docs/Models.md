# Models
A model represents a unit of logic with defined inputs, outputs, and parameters. The mapping of your model to real-world characteristics

## Interface
Model interfaces are defined with TOML files using datatypes from Julia. The default interface file that is generated for a model is named `idl.toml`. The `rsiswrap` tool takes that interface file and generates a collection of files that support the model itself.

| Name | Usage | Notes |
| --- | --- | --- |
| *_interface.rs | Structure definitions | |
| *_msgpack.rs | Wrapper metadata support | Gated by the `msgpack` feature |

### Data Types & Containers
These are the primitive data types supported in all scenarios by RSIS.
| Primitive Julia Data Type | Rust Type |
| --- | --- |
| Bool | bool |
| Char | char |
| String | String |
| Int8 | i8 |
| Int16 | i16 |
| Int32 | i32 |
| Int64 | i64 |
| UInt8 | u8 |
| UInt16 | u16 |
| UInt32 | u32 |
| UInt64 | u64 |
| Float32 | f32 |
| Float64 | f64 |
| ComplexF32 | Complex32 |
| ComplexF64 | Complex64 |

The `Complex32` & `Complex64` types originate from the `num-complex` crate that is included in all models.

Future: `Rational{Int32}` & `Rational{Int64}` with the `num-rational` crate.

| Julia Container Type | Rust Type | Restriction(s) |
| --- | --- | --- |
| Dict{K, V} | HashMap&lt;K, V&gt; | Cannot be used as an input or output. K & V must be primitive types. |
| Vector{T} | Vec&lt;T&gt; | Cannot be used as an input or output. T must be a primitive type .|

### Dimensions
The `nalgebra` crate is used by RSIS for the `Matrix` type, restricting the dimension of matrices to 2.

### Generics
User defined structures can be made generic. This allows for creation of models that can further specialized via primitive types. Generics can be optionally restricted to specific primitive types.

For instance, the `sine` utility model is generic over `T`, where `T` is restricted to âˆˆ `[Float32, Float64]`. This allows the same model source to be reused without need of a data type conversion.

## MessagePack
Autogenerated structures for decoding & encoding the model interface are created and put behind a feature. This is done to support the dynamic simulation, allowing for Jula to interact with these models.

Most data types are natively supported by MessagePack. Noted exceptions and custom handling are as follows:

- `ComplexF32`, `ComplexF64`
    - Are treated as objects: `{"re", "im"}`
    - Supported with `num-complex` serde support
- Multidimensional arrays
    - Are treated as single-dimensional arrays, reshaped on both ends to their proper forms. Data must be passed in column major format.
TODO
- `Rational{Int32}`
    - Are treated as 2 element arrays of `Int32`
- `Rational{Int64}`
    - Are treated as 2 element arrays of `Int64`

For more details about the internal API that is used for the messagepack interface to each model, please see [this document](./autocoding/messagepack_interface.md).
